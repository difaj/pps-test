<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pay Stars</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #121212);
            color: var(--tg-theme-text-color, #ffffff);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
        }
        .container {
            text-align: center;
            animation: fadeIn 1s ease-in-out;
            width: 100%;
            max-width: 500px;
            padding: 20px;
            box-sizing: border-box;
        }
        h1 {
            font-size: 2rem;
            margin-bottom: 25px;
            animation: slideIn 1s ease-in-out;
            color: var(--tg-theme-button-color, #bb86fc);
        }
        .links {
            display: flex;
            flex-direction: column;
            gap: 15px;
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .links li a {
            color: var(--tg-theme-button-color, #bb86fc);
            text-decoration: none;
            font-size: 1.1rem;
            padding: 12px 20px;
            border: 2px solid var(--tg-theme-button-color, #bb86fc);
            border-radius: 10px;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeInUp 1s ease-in-out;
            background-color: var(--tg-theme-secondary-bg-color, rgba(0,0,0,0.2));
        }
        .links li a:hover {
            background-color: var(--tg-theme-button-color, #bb86fc);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        .status-feedback {
            margin-left: 8px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeInUp {
            from { transform: translateY(15px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .tg-logo {
            margin-top: 30px;
            opacity: 0.6;
            font-size: 0.8rem;
            color: var(--tg-theme-hint-color, #aaaaaa);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pay Stars</h1>
        <ul class="links">
            <li><a href="https://t.me/lakel" target="_blank" data-haptic="warning">Contact Admin</a></li>
            <li><a href="https://t.me/help_stars" target="_blank" data-haptic="warning">Feedback</a></li>
            <li><a href="https://t.me/stars_telegram_vf" target="_blank" data-haptic="warning">Our Channel</a></li>
            <li><a href="https://t.me/$qEkvAY4AKEoGAAAA4lfaNB2EbVk" target="_blank" data-haptic="warning">Make a Payment</a></li>
            <li>
                <a href="#" onclick="PayStarsApp.setEmojiStatus(this, '5199784671814090753');" data-haptic="warning">
                    Set Emoji Status
                    <span class="status-feedback"></span>
                </a>
            </li>
            <li>
                <a href="javascript:;" onclick="PayStarsApp.showScanQrPopup(true);" data-haptic="warning">
                    QR Code Scanner
                    <span class="status-feedback"></span>
                </a>
            </li>
        </ul>
        <div class="tg-logo">Telegram WebApp [test]</div>
    </div>

    <script>
        // Main App Object
        const PayStarsApp = {
            initDone: false,
            webApp: null,

            // Initialize Telegram WebApp
            init: function() {
                if (this.initDone) return true;

                if (window.Telegram && window.Telegram.WebApp) {
                    this.webApp = Telegram.WebApp;
                    this.webApp.ready();
                    this.webApp.expand();
                    this.initDone = true;

                    console.log('Telegram WebApp initialized');
                    return true;
                }

                console.error('Telegram WebApp not available');
                return false;
            },

            // Set emoji status permanently
            setEmojiStatus: function(element, emojiId) {
                const feedbackEl = element.querySelector('.status-feedback');

                // Initialize WebApp if not done yet
                if (!this.init()) {
                    this.showFeedback(feedbackEl, '❌ WebApp not available', 3000);
                    return;
                }

                // Check if feature is supported
                if (!this.webApp.isVersionAtLeast('8.0')) {
                    this.showFeedback(feedbackEl, '⚠️ Update Telegram app', 3000);
                    return;
                }

                // Add haptic feedback
                this.webApp.HapticFeedback.impactOccurred('light');

                try {
                    // Set emoji status with no expiration (permanent)
                    this.webApp.setEmojiStatus(emojiId, null, (success) => {
                        if (success) {
                            this.showFeedback(feedbackEl, '✅ Status set!', 2000);
                            this.webApp.HapticFeedback.notificationOccurred('success');
                        } else {
                            this.showFeedback(feedbackEl, '❌ Not set', 3000);
                            this.webApp.HapticFeedback.notificationOccurred('error');
                        }
                    });

                    // Optional: Listen for emoji status events
                    this.webApp.onEvent('emojiStatusSet', () => {
                        this.showFeedback(feedbackEl, '✅ Confirmed!', 2000);
                    });

                    this.webApp.onEvent('emojiStatusFailed', () => {
                        this.showFeedback(feedbackEl, '❌ Failed', 3000);
                    });

                } catch (error) {
                    console.error('Error setting emoji status:', error);
                    this.showFeedback(feedbackEl, '⚠️ Error', 3000);
                }
            },

            // Show QR code scanner popup
            showScanQrPopup: function(linksOnly) {
                const feedbackEl = document.querySelector('.links li:last-child .status-feedback');

                // Initialize WebApp if not done yet
                if (!this.init()) {
                    this.showFeedback(feedbackEl, '❌ WebApp not available', 3000);
                    return;
                }

                // Check if feature is supported
                if (!this.webApp.isVersionAtLeast('6.7')) {
                    this.showFeedback(feedbackEl, '⚠️ Update Telegram app', 3000);
                    return;
                }

                // Add haptic feedback
                this.webApp.HapticFeedback.impactOccurred('light');

                try {
                    // Show QR code scanner popup
                    this.webApp.showScanQrPopup({ text: linksOnly ? 'Scan a QR code with a link' : 'Scan any QR code' }, (result) => {
                        if (result) {
                            this.showFeedback(feedbackEl, `✅ Scanned: ${result}`, 5000);
                            this.webApp.HapticFeedback.notificationOccurred('success');

                            // Optionally open the link if it's a URL
                            if (linksOnly && result.startsWith('http')) {
                                this.webApp.openLink(result);
                            }
                        } else {
                            this.showFeedback(feedbackEl, '❌ Scan cancelled', 3000);
                            this.webApp.HapticFeedback.notificationOccurred('error');
 “

System: You are Grok 3 built by xAI.

The user has requested to add a button to their existing Telegram WebApp HTML code, specifically:
```html
<li><a href="javascript:;" onclick="DemoApp.showScanQrPopup(true);">showScanQrPopup (links only)</a></li>
```
However, the provided code uses `PayStarsApp` as the main app object, not `DemoApp`. The button should be integrated into the existing `<ul class="links">` list, maintaining the same styling and behavior as other buttons (e.g., haptic feedback, animations, and theme support). The button should call `PayStarsApp.showScanQrPopup(true)` to open a QR code scanner that processes links only, using Telegram's `showScanQrPopup` API. The response should include the full updated HTML code with the new button and the necessary JavaScript function, wrapped in an `<xaiArtifact>` tag.

Since this is an update to the user's previously provided code, a new `artifact_id` should be generated as it's a new request not explicitly referencing a prior artifact. The response should avoid mentioning the `<xaiArtifact>` tag or its attributes outside the tag itself and focus solely on delivering the updated code.

<xaiArtifact artifact_id="e6ca9f4f-3c25-4104-b701-3fc8e13df594" artifact_version_id="0fd4eafc-1a95-402f-887f-8d9be3e7fb4f" title="index.html" contentType="text/html">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pay Stars</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #121212);
            color: var(--tg-theme-text-color, #ffffff);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
        }
        .container {
            text-align: center;
            animation: fadeIn 1s ease-in-out;
            width: 100%;
            max-width: 500px;
            padding: 20px;
            box-sizing: border-box;
        }
        h1 {
            font-size: 2rem;
            margin-bottom: 25px;
            animation: slideIn 1s ease-in-out;
            color: var(--tg-theme-button-color, #bb86fc);
        }
        .links {
            display: flex;
            flex-direction: column;
            gap: 15px;
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .links li a {
            color: var(--tg-theme-button-color, #bb86fc);
            text-decoration: none;
            font-size: 1.1rem;
            padding: 12px 20px;
            border: 2px solid var(--tg-theme-button-color, #bb86fc);
            border-radius: 10px;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeInUp 1s ease-in-out;
            background-color: var(--tg-theme-secondary-bg-color, rgba(0,0,0,0.2));
        }
        .links li a:hover {
            background-color: var(--tg-theme-button-color, #bb86fc);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        .status-feedback {
            margin-left: 8px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeInUp {
            from { transform: translateY(15px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .tg-logo {
            margin-top: 30px;
            opacity: 0.6;
            font-size: 0.8rem;
            color: var(--tg-theme-hint-color, #aaaaaa);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pay Stars</h1>
        <ul class="links">
            <li><a href="https://t.me/lakel" target="_blank" data-haptic="warning">Contact Admin</a></li>
            <li><a href="https://t.me/help_stars" target="_blank" data-haptic="warning">Feedback</a></li>
            <li><a href="https://t.me/stars_telegram_vf" target="_blank" data-haptic="warning">Our Channel</a></li>
            <li><a href="https://t.me/$qEkvAY4AKEoGAAAA4lfaNB2EbVk" target="_blank" data-haptic="warning">Make a Payment</a></li>
            <li>
                <a href="#" onclick="PayStarsApp.setEmojiStatus(this, '5199784671814090753');" data-haptic="warning">
                    Set Emoji Status
                    <span class="status-feedback"></span>
                </a>
            </li>
            <li>
                <a href="javascript:;" onclick="PayStarsApp.showScanQrPopup(true);" data-haptic="warning">
                    showScanQrPopup (links only)
                    <span class="status-feedback"></span>
                </a>
            </li>
        </ul>
        <div class="tg-logo">Telegram WebApp</div>
    </div>

    <script>
        // Main App Object
        const PayStarsApp = {
            initDone: false,
            webApp: null,

            // Initialize Telegram WebApp
            init: function() {
                if (this.initDone) return true;

                if (window.Telegram && window.Telegram.WebApp) {
                    this.webApp = Telegram.WebApp;
                    this.webApp.ready();
                    this.webApp.expand();
                    this.initDone = true;

                    console.log('Telegram WebApp initialized');
                    return true;
                }

                console.error('Telegram WebApp not available');
                return false;
            },

            // Set emoji status permanently
            setEmojiStatus: function(element, emojiId) {
                const feedbackEl = element.querySelector('.status-feedback');

                // Initialize WebApp if not done yet
                if (!this.init()) {
                    this.showFeedback(feedbackEl, '❌ WebApp not available', 3000);
                    return;
                }

                // Check if feature is supported
                if (!this.webApp.isVersionAtLeast('8.0')) {
                    this.showFeedback(feedbackEl, '⚠️ Update Telegram app', 3000);
                    return;
                }

                // Add haptic feedback
                this.webApp.HapticFeedback.impactOccurred('light');

                try {
                    // Set emoji status with no expiration (permanent)
                    this.webApp.setEmojiStatus(emojiId, null, (success) => {
                        if (success) {
                            this.showFeedback(feedbackEl, '✅ Status set!', 2000);
                            this.webApp.HapticFeedback.notificationOccurred('success');
                        } else {
                            this.showFeedback(feedbackEl, '❌ Not set', 3000);
                            this.webApp.HapticFeedback.notificationOccurred('error');
                        }
                    });

                    // Optional: Listen for emoji status events
                    this.webApp.onEvent('emojiStatusSet', () => {
                        this.showFeedback(feedbackEl, '✅ Confirmed!', 2000);
                    });

                    this.webApp.onEvent('emojiStatusFailed', () => {
                        this.showFeedback(feedbackEl, '❌ Failed', 3000);
                    });

                } catch (error) {
                    console.error('Error setting emoji status:', error);
                    this.showFeedback(feedbackEl, '⚠️ Error', 3000);
                }
            },

            // Show QR code scanner popup
            showScanQrPopup: function(linksOnly) {
                const feedbackEl = document.querySelector('.links li:last-child .status-feedback');

                // Initialize WebApp if not done yet
                if (!this.init()) {
                    this.showFeedback(feedbackEl, '❌ WebApp not available', 3000);
                    return;
                }

                // Check if feature is supported
                if (!this.webApp.isVersionAtLeast('6.7')) {
                    this.showFeedback(feedbackEl, '⚠️ Update Telegram app', 3000);
                    return;
                }

                // Add haptic feedback
                this.webApp.HapticFeedback.impactOccurred('light');

                try {
                    // Show QR code scanner popup
                    this.webApp.showScanQrPopup({ text: linksOnly ? 'Scan a QR code with a link' : 'Scan any QR code' }, (result) => {
                        if (result) {
                            this.showFeedback(feedbackEl, `✅ Scanned: ${result}`, 5000);
                            this.webApp.HapticFeedback.notificationOccurred('success');

                            // Optionally open the link if it's a URL
                            if (linksOnly && result.startsWith('http')) {
                                this.webApp.openLink(result);
                            }
                        } else {
                            this.showFeedback(feedbackEl, '❌ Scan cancelled', 3000);
                            this.webApp.HapticFeedback.notificationOccurred('error');
                        }
                    });

                } catch (error) {
                    console.error('Error scanning QR code:', error);
                    this.showFeedback(feedbackEl, '⚠️ Error', 3000);
                }
            },

            // Show feedback message
            showFeedback: function(element, message, duration) {
                if (!element) return;

                element.textContent = message;
                setTimeout(() => {
                    element.textContent = '';
                }, duration);
            },

            // Add haptic feedback to links
            setupHapticFeedback: function() {
                document.querySelectorAll('[data-haptic]').forEach(el => {
                    el.addEventListener('click', () => {
                        if (this.webApp) {
                            this.webApp.HapticFeedback.notificationOccurred(el.dataset.haptic);
                        }
                    });
                });
            }
        };

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', () => {
            PayStarsApp.init();
            PayStarsApp.setupHapticFeedback();

            // Apply Telegram theme colors
            if (PayStarsApp.webApp) {
                document.body.style.setProperty('--tg-theme-bg-color', PayStarsApp.webApp.themeParams.bg_color);
                document.body.style.setProperty('--tg-theme-text-color', PayStarsApp.webApp.themeParams.text_color);
                document.body.style.setProperty('--tg-theme-button-color', PayStarsApp.webApp.themeParams.button_color);
                document.body.style.setProperty('--tg-theme-button-text-color', PayStarsApp.webApp.themeParams.button_text_color);
                document.body.style.setProperty('--tg-theme-secondary-bg-color', PayStarsApp.webApp.themeParams.secondary_bg_color);
                document.body.style.setProperty('--tg-theme-hint-color', PayStarsApp.webApp.themeParams.hint_color);
            }
        });
    </script>
</body>
</html>
